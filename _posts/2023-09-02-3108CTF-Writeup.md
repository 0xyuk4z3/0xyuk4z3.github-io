---
title: "3108 CTF: Warkah Untuk Perwira Writeup"
image: https://github.com/user-attachments/assets/a4c0aa29-5b1a-4659-9d29-0704e5bfd43e
date: 2023-09-02 00:00:00 +/-0800
categories: [Writeups]
tags: [CTF]     # TAG names should always be lowercase
---
![1727345866185](../assets/img/2023-09-02-3108CTF-Writeup/1727345866185.png)

Welcome to my write-up for the 3108 CTF: Warkah Untuk Perwira organized by BahteraSiber. This CTF presented numerous smaller challenges, but I will be focusing on providing in-depth writeups of the main challenges that highlight key ethical hacking methodologies.

# Tugasan Utama

## Tugasan I: Seruan Perwira

![1727422997291](../assets/img/2023-09-02-3108CTF-Writeup/1727422997291.png)

It seems like a local hacker group called ITSLOKI has been threatening Malaysia's cybersecurity landscape, their motivations is mainly about revenge as their efforts have been stopped by the government before. Lee, working as a spy sends us a link saying that we must analyze a certain file in that link. Let's open it right away...

> https://www.youtube.com/watch?v=DFBNEsKJW6I&ab_channel=BahteraSiberMY

![1727425761973](../assets/img/2023-09-02-3108CTF-Writeup/1727425761973.png)

It seems that the video is from the ITSLOKI group stating that they possess a large sums of local and are threatening to sell all the data. He is challenging others to stop him! In the video description, there seems to be a download link which is given by Lee from earlier. Let's download and analyze the file.

It is a zip file, so we extract it to see the contents, and it seems to be an eml file which is **an electronic mail format or email saved in plain text.** There is also an zipped attachment inside the email.

![1727426342871](../assets/img/2023-09-02-3108CTF-Writeup/1727426342871.png)

![1727425930854](../assets/img/2023-09-02-3108CTF-Writeup/1727425930854.png)

Inside appears to be a morse code, let's try to decrypt it right away.

![1727425831695](../assets/img/2023-09-02-3108CTF-Writeup/1727425831695.png)

We assume that the secret 4 digit code is 3108. Let's keep that in mind and let's now try to extract the attachment in the email.

![1727426695725](../assets/img/2023-09-02-3108CTF-Writeup/1727426695725.png)

There seems to be two files inside, an image file and a flag.txt file. Now if we try to extract, it asks for a password. With the earlier hint, we entered "3108"" as the password and we get the flag for the first part of the task. The flag is **3108{1E2A3C68CC5C0207886EDE403EEF230DC7C0FBD0}**

![1727426815597](../assets/img/2023-09-02-3108CTF-Writeup/1727426815597.png)

![1727426778788](../assets/img/2023-09-02-3108CTF-Writeup/1727426778788.png)

## Tugasan II: Tali Barut

![1727426912517](../assets/img/2023-09-02-3108CTF-Writeup/1727426912517.png)

The task seems to hint us at performing some OSINT on the ITSLOKI group to find out more information about them. The group seems to have been promoting hacking classes on social media with the intention of recruiting more black hat hackers on their side. Sambanthan tells us that he has left multiple files and secret message for us to analyze in a server. 

Inspecting the image earlier that we got from the eml file, there seems to be names of the ITSLOKI members. So let's start with that, we try to look for the next clue through searching social media using their usernames on the image.

![1727427234769](../assets/img/2023-09-02-3108CTF-Writeup/1727427234769.png)

After doing some OSINT, we find this account @p3tualang on TikTok. After checking out all the videos one by one.. we find that there is a discord link in one of the posts. Let's enter their group to investigate further.

![1727427316805](../assets/img/2023-09-02-3108CTF-Writeup/1727427316805.png)

Now that we have entered in their discord, let's see if there any further clues, and remember that Sambathan has left us some secret messages and files. Let's try to find that by going through all the channels one by one.

![1727427400625](../assets/img/2023-09-02-3108CTF-Writeup/1727427400625.png)

After examining all the channels, what caught our eyes are what appears to be some secret message in the "TOPI HITAM" channel category.

![1727427819031](../assets/img/2023-09-02-3108CTF-Writeup/1727427819031.png)

![1727427834325](../assets/img/2023-09-02-3108CTF-Writeup/1727427834325.png)

![1727427849637](../assets/img/2023-09-02-3108CTF-Writeup/1727427849637.png)

It seems to be some sort of cipher, and there is the number **31** and **08** which seems to indicate that this is a encrypted flag. We just need to find out what type of encryption is this and try to decrypt it. First, let's combine all of this into a proper order. The code which contains 31 probably precedes the 08. It will look something like this.

`baabbaaaaaaabbbabbababaaaaaaaaaabbb abbbbaabaabaaabbabbaabaaabaaabaaaaa! aaaaaabbabaaabbaaaaa baabbaabaaababbaaaaaaabbb abbaaaabaaabbababaabbabaaabbaaabbbbaaaaaabaaa abaabaaaaababbaaaaaaabbbbaaaaaabbab. 3108{baaba3abbabbaabb14baabaaaaaa_abbbb3ababaaaaaa}. abaaabaabbbaabaababbabbbaababaabaaa aabbababaaabbabaaaaa aaaba2 babaaabbabbaabbbabaaababa abbaaaabaaabbabbbaaaaabaabaaabaaaaaabbabaabba abbaaaaaaaababbaaaaabbaaabaabaabaaaaaaaa. aaabaaaaaabaaababaaa aabaaabbabaaababaaabbba aaabbbbbaabbaabaaaaabb baabbaabaababbbbaabb aaabbababbabbaa baabaaabaabaaabbababaabaabaaab aaabbabaaabaabaaaabaabbbabaaabaaabb abaaabaabbbaabaababbabbbaababaabaaa aaabbaaaaaabbab baabaaabaabaaabaaaaaabbabaabba baabaaabaabaaabbababaabaabaaab aaaba2 abbaaaabaabaaabaabaaababaaaaaa! -baabaaaaaaabbaaaaaabaaaaabaabbaabbbaaaaaabbab`

![1727428218644](../assets/img/2023-09-02-3108CTF-Writeup/1727428218644.png)

Using a tool to analyze the cipher text, it seems to be encrypted with Bacon Cipher. Let's try to decrypt it now.

**TAHNIAHPERWIRAANDATELAHMENJUMPAIJAWAPANSNTSAPKAITSLOKIGUNACUNTUKMENYERANGMALAYSIACARIENCRYPTEDTEXTDLMSERVERDISCORDITSLOKIDANSERANGSERVERCMEREKASAMBATHAN**

We get this when decrypting the message, however it still seems to be a little scrambled. This is probably because there are characters and numbers in the message which shouldn't be in a Bacon Cipher. Now let's try to remove all the unneeded characters and only focus on the flag part which starts with 3108{ }. Let's try to decrypt the text by breaking it down like this

`3108{baaba3abbabbaabb14baabaaaaaa_abbbb3ababaaaaaa}.`

![1727429527845](../assets/img/2023-09-02-3108CTF-Writeup/1727429527845.png)

Now the spaces should probably be replaced by the numbers in the original cipher text as Bacon Cipher should only contain 'a' and 'b'. Combining all of them yields us the second flag!

The flag is **3108{S3NT14SA_P3KA}**

## Tugasan III: Pangkalan Gelap

![1727429712836](../assets/img/2023-09-02-3108CTF-Writeup/1727429712836.png)

ITSLOKI seems to have a webserver which they operate to sell and leak hacked data. The task says that there is already someone that managed to get in their server and has left us with a message. It seems that we must perform penetration testing into the box which hosts the web server. There are two ways to get the box which is through a Google Drive link and also a TryHackMe room. Let's now go back into the discord server to find some clues.

In the **#chat-biasa2** channel, there seems to be a python code, let's try to run it and see what happens.


[https://drive.google.com/file/d/1KyOkNvQ9Z53AAlF_M52DjAeKf9YiN8-U/view](https://drive.google.com/file/d/1KyOkNvQ9Z53AAlF_M52DjAeKf9YiN8-U/view)

In the **#rat** channel, there seems to be a broken C code. Let's fix it and try to run it to see the output of the code.

Before:

```c

#include <stdio.h>

int main() {
    int part1[] = { 122, 120, 226, 140, 130, 110, 103, 105, 113, 115, 107, 52 };
    int part2[] = { 105, 117, 115, 53, 112, 120, 53, 57, 55, 54, 62, 105, 122, 108, 125 };
    int part3[] = { 103, 120, 113, 103, 110, 123, 116, 122, 123, 113, 118, 107, 120, 125, 111, 120, 103 };

    char finalValue[50]; 

    int = 0;
    for (int i = 0; i < sizeof(xxxx) / sizeof(part1[0]); i++) {
        finalValue[index++] = (char)part1[i];
    }
    for (int 0 = 0; i < sizeof(part2) / sizeof(part2[0]); i++) {
   
    }
    for (int i = 0; i < sizeof(part3) / sizeof(part3[0]); i++) {
        finalValue[index++];


    printf("Final value: %s\n", finalValue);

    return 0;
}
```

After:

```c
#include <stdio.h>

int main() {
    int part1[] = { 122, 120, 226, 140, 130, 110, 103, 105, 113, 115, 107, 52 };
    int part2[] = { 105, 117, 115, 53, 112, 120, 53, 57, 55, 54, 62, 105, 122, 108, 125 };
    int part3[] = { 103, 120, 113, 103, 110, 123, 116, 122, 123, 113, 118, 107, 120, 125, 111, 120, 103 };

    char finalValue[50]; 

    int index = 0;
    for (int i = 0; i < sizeof(part1) / sizeof(part1[0]); i++) {
        finalValue[index++] = (char)part1[i];
    }
    for (int i = 0; i < sizeof(part2) / sizeof(part2[0]); i++) {
        finalValue[index++] = (char)part2[i];
    }
    for (int i = 0; i < sizeof(part3) / sizeof(part3[0]); i++) {
        finalValue[index++] = (char)part3[i];;
    }

    printf("Final value: %s\n", finalValue);

    return 0;
}
```

Now that the code has been fixed, let's try to run it now.

![1727431487002](../assets/img/2023-09-02-3108CTF-Writeup/1727431487002.png)

The output that we get is

```
zxâŒ‚ngiqsk4ius5px5976>izl}gxqgn{tz{qvkx}oxg@
```

![1727431675558](../assets/img/2023-09-02-3108CTF-Writeup/1727431675558.png)

It seems to be a ROT ciphertext, decrypting it yields us a TryHackMe room. 

[tryhackme.com/jr/3108ctfwarkahuntukperwira](tryhackme.com/jr/3108ctfwarkahuntukperwira)

![1727432203419](../assets/img/2023-09-02-3108CTF-Writeup/1727432203419.png)





















## Bonus Merdeka Quest

> This is a small write up for the bonus Merdeka giveaway.
> {: .prompt-info }

Let's start by going into the google drive link provided. Download the files and examine the contents.

![1727355020330](../assets/img/2023-09-02-3108CTF-Writeup/1727355020330.png)

A quick analysis using these two commands.

```shell
cat info.txt
file dumb.raw
```

![1727355157259](../assets/img/2023-09-02-3108CTF-Writeup/1727355157259.png)

![1727355164240](../assets/img/2023-09-02-3108CTF-Writeup/1727355164240.png)

After examining, it seems like we would have to find a flag with the format 3108{FLAG} inside the .raw file which we further analyzed using the **file** command. We reckon that it might be a windows memory dump file.

For memory dumps, we can use volatility3 for further analysis... let's download the tool.

[https://github.com/volatilityfoundation/volatility3](https://github.com/volatilityfoundation/volatility3)

```shell
git clone https://github.com/volatilityfoundation/volatility3.git
cd volatility3
```

Start the tool and let's check out the help page to see what we can work with. Since we know this is a windows dump file, we will just focus on the windows plugins.

```shell
python3 vol.py -h
```

![1727355253606](../assets/img/2023-09-02-3108CTF-Writeup/1727355253606.png)

Considering that we would have to somehow find a flag, the flag text might be placed in a file. So, let's first scan for files by using the** windows.filescan** plugin. The plugin lists all the files that are in the memory dump.

```shell
vol.py -f dumb.raw windows.filescan 
```

![1727355285381](../assets/img/2023-09-02-3108CTF-Writeup/1727355285381.png)

After the scan finishes.. as a start, let's just try using the search function (CTRL + SHIFT + F) in the terminal to find any files named "flag"... and we found two files named **flag.rtf** and **flag or not.txt.**

![1727355311089](../assets/img/2023-09-02-3108CTF-Writeup/1727355311089.png)

![1727355325691](../assets/img/2023-09-02-3108CTF-Writeup/1727355325691.png)

Now that we found the flag files, we can examine the content by dumping the files using the **windows.dumpfiles **plugin. We take the respective offset number from the filescan results for each of the files so we can examine individually. We output the results in a folder we created name "files".

| Offset         | File name       |
| -------------- | --------------- |
| 0x96080108ec30 | flag.rtf        |
| 0x960802c47830 | flag_or_not.txt |

```shell
python3 vol.py -f dumb.raw -o ./files windows.dumpfiles --virtaddr 0x96080108ec30
python3 vol.py -f dumb.raw -o ./files windows.dumpfiles --virtaddr 0x960802c47830
```

Examine the content of the files in the folder that we outputted using a rich text format editor for the** .rtf **file.

![1727355467525](../assets/img/2023-09-02-3108CTF-Writeup/1727355467525.png)

![1727355473273](../assets/img/2023-09-02-3108CTF-Writeup/1727355473273.png)

The flag is **3108{MEMORY-DUMP}**
